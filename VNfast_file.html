<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="UTF-8">
<title>Truy cập tài liệu</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
body{
    margin:0;
    font-family: Arial, sans-serif;
    background: linear-gradient(135deg,#fde2e4,#e0f4ff);
    min-height:100vh;
    display:flex;
    justify-content:center;
    align-items:center;
    overflow:hidden;
}

.container{
    background:#ffffffdd;
    backdrop-filter: blur(6px);
    padding:25px 22px 30px;
    border-radius:20px;
    text-align:center;
    max-width:360px;
    box-shadow:0 10px 30px rgba(0,0,0,.15);
    z-index:2;
}

.avatar{
    width:120px;
    height:120px;
    margin:0 auto 15px;
    border-radius:50%;
    overflow:hidden;
    border:5px solid #f8bbd0;
}
.avatar img{
    width:100%;
    height:100%;
    object-fit:cover;
}

p{
    font-size:14px;
    color:#555;
    line-height:1.5;
}

button{
    margin-top:15px;
    padding:12px 26px;
    font-size:15px;
    border:none;
    border-radius:25px;
    background:#ba68c8;
    color:#fff;
    cursor:pointer;
}
button:hover{opacity:.9}

#status{
    margin-top:12px;
    font-weight:bold;
    color:#e53935;
}

#countdown{
    margin-top:10px;
    font-weight:bold;
    color:#6a1b9a;
}

/* SNOW */
.snow{
    position:fixed;
    top:-10px;
    color:#fff;
    font-size:18px;
    pointer-events:none;
    animation: fall linear infinite;
}
@keyframes fall{
    to{ transform: translateY(110vh); }
}
</style>
</head>

<body>

<div class="container">
    <div class="avatar">
        <img src="https://sf-static.upanhlaylink.com/img/image_20251218be9bb481d1c7a17aba1c6210769a287c.jpg">
    </div>

    <p>
        “ Nhấp vào nút truy cập phía bên dưới, sau khi vào shopee hãy đợi 10 giây
        rồi trở lại vào web để truy cập File hay tài liệu cần lấy “
    </p>

    <button id="mainBtn">Truy cập</button>
    <div id="countdown"></div>
    <div id="status"></div>
</div>

<script>
/* ===== CONFIG ===== */
const WAIT_TIME = 10 * 1000;
const FILE_TIME = 5 * 60 * 1000;

const KEY_START = "start_time";
const KEY_UNLOCK = "unlock_time";

/* ===== ELEMENT ===== */
const btn = document.getElementById("mainBtn");
const status = document.getElementById("status");
const countdownEl = document.getElementById("countdown");

let timer = null;

/* ===== RESET ===== */
function reset(msg){
    localStorage.removeItem(KEY_START);
    localStorage.removeItem(KEY_UNLOCK);
    btn.innerText = "Truy cập";
    btn.style.display = "inline-block";
    btn.onclick = startAccess;
    countdownEl.innerText = "";
    status.innerText = msg || "";
    if(timer) clearInterval(timer);
}

/* ===== START ACCESS ===== */
function startAccess(){
    const now = Date.now();
    localStorage.setItem(KEY_START, now);
    status.innerText = "";
    btn.style.display = "none";
    startCountdown(now);
    window.location.href = "https://s.shopee.vn/6Ae4C7ROMz";
}

/* ===== COUNTDOWN DISPLAY ===== */
function startCountdown(start){
    if(timer) clearInterval(timer);
    timer = setInterval(()=>{
        const remain = WAIT_TIME - (Date.now() - start);
        if(remain > 0){
            countdownEl.innerText = `⏳ Đang đếm: ${Math.ceil(remain/1000)} giây`;
        }else{
            countdownEl.innerText = "✔ Đã đủ 10 giây";
            clearInterval(timer);
        }
    },500);
}

/* ===== CHECK STATE ===== */
function checkState(){
    const start = localStorage.getItem(KEY_START);
    const unlock = localStorage.getItem(KEY_UNLOCK);
    const now = Date.now();

    /* ĐÃ MỞ FILE */
    if(unlock){
        if(now - unlock >= FILE_TIME){
            reset("");
        }else{
            btn.innerText = "Truy cập tài liệu & File";
            btn.style.display = "inline-block";
            btn.onclick = ()=>{
                window.location.href =
                "https://docs.google.com/document/d/1-AczkDnMaiETz8CXb42j3FEo7GWReKLjln5seMIFPvg/edit?usp=drivesdk";
            };
        }
        return;
    }

    if(!start) return;

    const diff = now - start;

    if(diff < WAIT_TIME){
        const thiếu = Math.ceil((WAIT_TIME - diff)/1000);
        reset(`❌ Chưa đủ thời gian truy cập – còn thiếu ${thiếu} giây`);
    }else{
        localStorage.setItem(KEY_UNLOCK, now);
        btn.innerText = "Truy cập tài liệu & File";
        btn.style.display = "inline-block";
        btn.onclick = ()=>{
            window.location.href =
            "https://docs.google.com/document/d/1-AczkDnMaiETz8CXb42j3FEo7GWReKLjln5seMIFPvg/edit?usp=drivesdk";
        };
        status.innerText = "✅ Hoàn tất xác nhận";
        countdownEl.innerText = "";
    }
}

/* ===== EVENTS ===== */
btn.onclick = startAccess;
window.addEventListener("pageshow", checkState);

/* ===== SNOW ===== */
for(let i=0;i<35;i++){
    const s=document.createElement("div");
    s.className="snow";
    s.innerText="❄";
    s.style.left=Math.random()*100+"vw";
    s.style.animationDuration=3+Math.random()*5+"s";
    s.style.fontSize=10+Math.random()*15+"px";
    document.body.appendChild(s);
}
</script>

</body>
</html>